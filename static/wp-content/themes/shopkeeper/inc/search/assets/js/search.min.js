!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"function"==typeof require?e(require("jquery")):e(jQuery)}(function(u){"use strict";function o(e,t){var n=u.noop,s=this,i={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,onMouseOver:null,onMouseLeave:null,width:"100%",minChars:1,maxHeight:1e3,deferRequestBy:0,params:{},delimiter:null,zIndex:9999,type:"GET",noCache:!1,is_rtl:!1,onSearchStart:n,onSearchComplete:n,onSearchError:n,preserveInput:!1,wrapperaClass:"search-wrapp",containerClass:"search-suggestions-wrapp",preloaderClass:"search-preloader",closeTrigger:"search-close",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,n){return-1!==e.value.toLowerCase().indexOf(n)},paramName:"query",transformResult:function(e){return"string"==typeof e?JSON.parse(e):e},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom"};s.element=e,s.el=u(e),s.suggestions=[],s.badQueries=[],s.selectedIndex=-1,s.currentValue=s.element.value,s.intervalId=0,s.cachedResponse={},s.detailsRequestsSent=[],s.onChangeInterval=null,s.onChange=null,s.isLocal=!1,s.suggestionsContainer=null,s.detailsContainer=null,s.noSuggestionsContainer=null,s.options=u.extend({},i,t),s.classes={selected:"search-suggestion-selected",suggestion:"search-suggestion"},s.hint=null,s.hintValue="",s.selection=null,s.initialize(),s.setOptions(t)}var e={escapeRegExChars:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.display="none",t}},n=27,s=9,i=13,a=38,l=39,r=40;o.utils=e,(u.Autocomplete=o).prototype={killerFn:null,initialize:function(){var e,t=this,n="."+t.classes.suggestion,s=(t.classes.selected,t.options),i="."+s.closeTrigger;t.killerFn=function(e){0===u(e.target).closest("."+t.options.containerClass).length&&(t.killSuggestions(),t.disableKillerFn())},t.suggestionsContainer=o.utils.createNode(s.containerClass),(e=u(t.suggestionsContainer)).appendTo(t.el.closest("."+s.wrapperaClass)),"auto"!==s.width&&e.width(s.width),e.on("mouseover.autocomplete",n,function(){t.onMouseOver(u(this).data("index")),t.activate(u(this).data("index"))}),e.on("mouseout.autocomplete",function(){}),u(document).on("click.autocomplete",i,function(e){t.killerFn(e),t.clear(e),u(this).removeClass(s.closeTrigger),t.el.val("").focus()}),e.on("click.autocomplete",n,function(){return t.select(u(this).data("index")),!1}),t.el.on("keydown.autocomplete",function(e){t.onKeyPress(e)}),t.el.on("keyup.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("change.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("input.autocomplete",function(e){t.onKeyUp(e)})},onFocus:function(){var e=this;e.el.val().length>=e.options.minChars&&e.onValueChange()},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions:function(e){var t=this,n=t.options;u.extend(n,e),t.isLocal=Array.isArray(n.lookup),t.isLocal&&(n.lookup=t.verifySuggestionsFormat(n.lookup)),n.orientation=t.validateOrientation(n.orientation,"bottom"),t.options.onSearchComplete=function(){t.preloader("hide",u("."+n.preloaderClass),n.closeTrigger)}},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.abortAjax()},enable:function(){this.disabled=!1},enableKillerFn:function(){u(document).on("click.autocomplete",this.killerFn)},disableKillerFn:function(){u(document).off("click.autocomplete",this.killerFn)},killSuggestions:function(){var e=this;u(e.suggestionsContainer).parent();e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.visible&&(e.options.preserveInput||e.el.val(e.currentValue),e.hide()),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this.el.val().length,n=this.element.selectionStart;return"number"==typeof n?n===t:!document.selection||((e=document.selection.createRange()).moveStart("character",-t),t===e.text.length)},onKeyPress:function(e){var t=this;if(t.disabled||t.visible||e.which!==r||!t.currentValue){if(!t.disabled&&t.visible){switch(e.which){case n:t.el.val(t.currentValue),t.hide();break;case l:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case s:if(t.hint&&t.options.onHint)return void t.selectHint();if(-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),!1===t.options.tabDisabled)return;break;case i:if(-1===t.selectedIndex)return void t.hide();t.select(t.selectedIndex);break;case a:t.moveUp();break;case r:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else t.suggest()},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case a:case r:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),0<t.options.deferRequestBy?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var e=this,t=e.options,n=e.el.val(),s=e.getQuery(n);e.selection&&e.currentValue!==s&&(e.selection=null,(t.onInvalidateSelection||u.noop).call(e.element)),clearInterval(e.onChangeInterval),e.currentValue=n,e.selectedIndex=-1,t.triggerSelectOnValidInput&&e.isExactMatch(s)?e.select(0):s.length<t.minChars?(u("."+e.options.closeTrigger).removeClass(e.options.closeTrigger),e.hide()):e.getSuggestions(s)},isExactMatch:function(e){var t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery:function(e){var t,n=this.options.delimiter;return n?(t=e.split(n),u.trim(t[t.length-1])):e},getSuggestionsLocal:function(t){var e,n=this.options,s=t.toLowerCase(),i=n.lookupFilter,o=parseInt(n.lookupLimit,10);return e={suggestions:u.grep(n.lookup,function(e){return i(e,t,s)})},o&&e.suggestions.length>o&&(e.suggestions=e.suggestions.slice(0,o)),e},getSuggestions:function(s){var e,t,n,i,o=this,a=u(o.suggestionsContainer),l=o.options,r=l.serviceUrl;l.params[l.paramName]=s,t=l.ignoreParams?null:l.params,o.preloader("show",u("."+l.preloaderClass),"search-inner-preloader",a),!1!==l.onSearchStart.call(o.element,l.params)&&(u.isFunction(l.lookup)?l.lookup(s,function(e){o.suggestions=e.suggestions,o.suggest(),l.onSearchComplete.call(o.element,s,e.suggestions)}):(o.isLocal?e=o.getSuggestionsLocal(s):(u.isFunction(r)&&(r=r.call(o.element,s)),n=r+"?"+u.param(t||{}),e=o.cachedResponse[n]),e&&Array.isArray(e.suggestions)?(o.suggestions=e.suggestions,o.suggest(),l.onSearchComplete.call(o.element,s,e.suggestions)):o.isBadQuery(s)?l.onSearchComplete.call(o.element,s,[]):(o.abortAjax(),i={url:r,data:t,type:l.type,dataType:l.dataType},u.extend(i,l.ajaxSettings),o.currentRequest=u.ajax(i).done(function(e){var t;o.currentRequest=null,void 0!==(t=l.transformResult(e,s)).suggestions&&o.processResponse(t,s,n),l.onSearchComplete.call(o.element,s,t.suggestions)}).fail(function(e,t,n){l.onSearchError.call(o.element,s,e,t,n)}))))},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,n=t.length;n--;)if(0===e.indexOf(t[n]))return!0;return!1},hide:function(){var e=this,t=u(e.suggestionsContainer),n=u(e.suggestionsContainer).parent();u.isFunction(e.options.onHide)&&e.visible&&e.options.onHide.call(e.element,t),e.visible=!1,e.selectedIndex=-1,clearInterval(e.onChangeInterval),u(e.suggestionsContainer).hide(),u(e.detailsContainer).hide(),n.removeClass("search-open"),e.signalHint(null)},suggest:function(){if(""!=this.suggestions){var e=this,t=e.options,n=(t.groupBy,t.formatResult,e.getQuery(e.currentValue)),s=e.classes.suggestion,i=e.classes.selected,o=u(e.suggestionsContainer),a=u(e.noSuggestionsContainer),l=t.beforeRender;t.triggerSelectOnValidInput&&e.isExactMatch(n)?e.select(0):(this.adjustContainerWidth(),a.detach(),o.html(e.suggestions),u.isFunction(l)&&l.call(e.element,o,e.suggestions),o.show(),o.parent().addClass("search-open"),t.autoSelectFirst&&(e.selectedIndex=0,o.scrollTop(0),o.children("."+s).first().addClass(i)),e.visible=!0,e.findBestHint())}else this.options.showNoSuggestionNotice?this.noSuggestions():this.hide()},noSuggestions:function(){},adjustContainerWidth:function(){var e,t=this.options,n=(u(this.suggestionsContainer).parent(),u(this.suggestionsContainer));"auto"===t.width&&(e=this.el.outerWidth(),n.css("width",e+"px"))},findBestHint:function(){this.el.val().toLowerCase()&&this.signalHint(null)},signalHint:function(e){var t="",n=this;e&&(t=n.currentValue+e.value.substr(n.currentValue.length)),n.hintValue!==t&&(n.hintValue=t,n.hint=e,(this.options.onHint||u.noop)(t))},preloader:function(e,t,n,s){var i="search-preloader-wrapp",o=null==n?i:i+" "+n;1==search.show_preloader&&0!=t.length&&("hide"===e&&(u(i).remove(),t.html(""),u(".search-suggestions-wrapp .products")[0]),"show"===e&&(s.html(""),t.html('<div class="'+o+'"></div>')))},validateOrientation:function(e,t){return e=u.trim(e||"").toLowerCase(),-1===u.inArray(e,["auto","bottom","top"])&&(e=t),e},processResponse:function(e,t,n){var s=this,i=s.options;i.noCache||(s.cachedResponse[n]=e,i.preventBadQueries&&!e.suggestions.length&&s.badQueries.push(t)),t===s.getQuery(s.currentValue)&&(s.suggestions=e.suggestions,s.suggest())},activate:function(e){var t,n=this,s=n.classes.selected,i=u(n.suggestionsContainer),o=i.find("."+n.classes.suggestion);return i.find("."+s).removeClass(s),n.selectedIndex=e,-1!==n.selectedIndex&&o.length>n.selectedIndex?(t=o.get(n.selectedIndex),u(t).addClass(s),t):null},selectHint:function(){var e=u.inArray(this.hint,this.suggestions);this.select(e)},select:function(e){this.hide(),this.onSelect(e),this.disableKillerFn()},moveUp:function(){var e=this;if(-1!==e.selectedIndex)return 0===e.selectedIndex?(u(e.suggestionsContainer).children().first().removeClass(e.classes.selected),e.selectedIndex=-1,e.el.val(e.currentValue),void e.findBestHint()):void e.adjustScroll(e.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(e){var t=this,n=t.activate(e);if(n){var s,i,o,a=u(n).outerHeight();s=n.offsetTop,o=(i=u(t.suggestionsContainer).scrollTop())+t.options.maxHeight-a,s<i?u(t.suggestionsContainer).scrollTop(s):o<s&&u(t.suggestionsContainer).scrollTop(s-t.options.maxHeight+a),t.options.preserveInput||t.el.val(t.getValue(t.suggestions[e].value)),t.signalHint(null)}},onSelect:function(e){var t=this,n=t.options.onSelect,s=t.suggestions[e];t.currentValue=t.getValue(s.value),t.currentValue===t.el.val()||t.options.preserveInput||t.el.val(t.currentValue),-1!=s.id&&(window.location.href=s.url),t.signalHint(null),t.suggestions=[],t.selection=s,u.isFunction(n)&&n.call(t.element,s)},onMouseOver:function(e){var t=this.options.onMouseOver,n=this.suggestions[e];u.isFunction(t)&&t.call(this.element,n)},onMouseLeave:function(e){var t=this.options.onMouseLeave,n=this.suggestions[e];u.isFunction(t)&&t.call(this.element,n)},getValue:function(e){var t,n,s=this.options.delimiter;return s?1===(n=(t=this.currentValue).split(s)).length?e:t.substr(0,t.length-n[n.length-1].length)+e:e},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),this.disableKillerFn(),u(this.suggestionsContainer).remove()}},u.fn.dgwtWcasAutocomplete=function(n,s){var i="autocomplete";return arguments.length?this.each(function(){var e=u(this),t=e.data(i);"string"==typeof n?t&&"function"==typeof t[n]&&t[n](s):(t&&t.dispose&&t.dispose(),t=new o(this,n),e.data(i,t))}):this.first().data(i)},u(function(){u(".search-input").dgwtWcasAutocomplete({minChars:3,autoSelectFirst:!1,triggerSelectOnValidInput:!1,serviceUrl:search.ajax_search_endpoint,paramName:"search_keyword"})})});